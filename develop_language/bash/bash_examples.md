# bash 脚本常用操作    

## 1. 正则表达式基本语法   
1.1 星号 `*`    
匹配 `*` 号前面的字符串或正则表达式任意次(`包括0次`)。   
比如：`1122*`   
可能匹配的字符串有：`112、1122、1122222、1123131231 ......`.  
**疑问**: 为什么会有 112 被匹配到?   
1.2 句号 `.`   
匹配除换行符之外的`任意一个`字符。   
比如：`112.`，将匹配`112`+`至少一个字符`   
可能匹配的字符串有：`1121、1122、112abc、1123131231 ......`，但不匹配`112`.  
**Note:** `.*`匹配匹配任意字符串。  
1.3 插入符号 `^`   
匹配一行的开始，但有时依赖于上下文环境，也可能表示`否定正则表达式`中一个字符串的意思。   
比如：`^abc`只匹配`行首`为 `abc` 的字符串.   
1.4 美元符 `$`    
在一个正则表达式的末尾，匹配一行的结尾。   
比如：`123$`，将只能匹配到`行尾`为 `123` 的字符行.    
**Note:** `^$` 匹配一个空行。   
1.5 方括号 `[]`   
匹配方括号内指定的字母集中的一个字符。   
比如：   
`[abc]`，将匹配字符 `a、b、c` 中的任意一个字符；   
`[^abc]`，将匹配除 `abc` 之外的所有字符。   
1.6 反斜线符号 `\`    
转义一个特殊的字符，使这个字符得到字面意义的解释。   
比如：`\$`，将表示它的字面字符 `$`； `\\`，表示 `\`。   
1.7 转义尖括号 `\<\>`  
用于标记单词边界。尖括号必须是转义的，否则它们只是字符的字面含义。  
比如：`\<the\>` 匹配 `the`，但不匹配 `them`，`there`。   
1.8 问号 `?`    
匹配 `0` 个或 `1` 个前面的字符，用于匹配单个字符。  
比如：`ab?c`，将匹配"ac"或"abc"。  
1.9 加号 `+`   
匹配一个或多个前面的字符，它和星号 `*` 很相似，但它不匹配 `0` 个字符的情况。   
比如：`ab+c`将匹配`abc`，`abbc`，`abbb...c`等。    
1.10 转义波形括号 `\{\}`   
指示匹配前面正则表达式的次数。波形括号必须是转义的，否则只有字符的字面含义。   
比如：`[0-9]\{5\}`将匹配 `5` 位数字。    
1.11 圆括号 `()`   
包含一组正则表达式。与 `|` 或 `expr` 操作符一起使用。  
1.12 竖线 `|`    
正则表达式的 `或` 操作符匹配一组可选的字符。  
比如：`a(b|c)d` 将匹配 `abd` 或 `acd`。  
1.13 比较运算符 `=~`  
必须在 `[[   ]]` 里面(不推荐使用),可直接用支持正则的工具代替.
```bash
$ digit=132
$ [[ $digit =~ [0-9] ]]
$ echo $?
0  # 说明上边的表达式为真

$ digit="sfsfs"
$ [[ $digit =~ [0-9] ]]
$ echo $?
1  # 说明上边的表达式为假
```

## 2. 实例  
以下是 `test_list.txt` 测试文件.  
```

```
2.1 查找包含字符串"112"且其后至少有一个字符的行.   
```bash
$ grep -nR "112." test_list.txt

1122
11222
1122222112
3131231112112
``` 
2.2 查找字符 "d" 和 "e" 之间有一个任意字符的行.    
```bash
$ grep -nR "d.e" test_list.txt 

abdde
bbdde
```
2.3 查找在字符"2"后有两个任意字符的行.   
```bash
$ grep -nR "2.." test_list.txt 

11222
2211
22111
1122222112
3131231112112
```
2.4 查找`/etc/passwd`文件中`root`账号的信息，不使用插入符号 `^` 匹配.    
```bash
$ grep -nR "root" /etc/passwd

root:x:0:0:root:/root:/bin/bash
operator:x:11:0:operator:/root:/sbin/nologin
```
2.5 查找`/etc/passwd`文件中`root`账号的信息，使用插入符号 `^` 匹配.   
```bash
$ grep -nR "^root" /etc/passwd

root:x:0:0:root:/root:/bin/bash
```
2.6 查看有空行有多少行.   
```bash
$ grep -nR "^$" test_list.txt | wc -l

3
```
2.7 查看所有匹配 `112*` 的行.    
```bash
$ grep -nR "112*" test_list.txt 

1122
112
11222
2211
22111
1122222112
3131231112112
```
2.8 查看所有以数字 `3` 开头，`2` 结尾的行.    
```bash
$ grep -nR "\<3.*2\>" test_list.txt --color

3131231112112
```
2.9 查看文件中含有至少 `8` 个连续小写字母的行.   
```bash
$ grep -nR "[a-z]\{8\}" test_list.txt 

bbcdefss
the people's replublic of China
fdoutjjlsjpwkfks
abdabeccde
```
